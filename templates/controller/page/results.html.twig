{% extends 'base.html.twig' %}
{# TODO: Fix this manual years result #}
{% set resultYears = [2014, 2015, 2016, 2017, 2018, 2019, 2020] %}
{% macro resultButton(year) %}
    <button id="result-button-{{ year }}"
            onclick="$(this).css({'background-image' : 'url({{ asset('build/images/15.gif') }})', 'background-repeat': 'no-repeat', 'background-position' : 'center'});
                    $('#results').load('/information_content/{{ year }}', function() {
                    $('#result-button-{{ year }}').css({'background-image' : 'url()'});
                    })"
            class="btn btn-new" role="button">
        {{ year }}
    </button>
{% endmacro %}

{% import _self as button %}

{% block body %}
    <div style="text-align: center; padding: 15px;">
        {% for year in resultYears %}
            {{ button.resultButton(year) }}
        {% endfor %}
        <a href="{{ path('results') }}" class="btn btn-new" role="button"
           onclick="$(this).css({'background-image' : 'url({{ asset('build/images/15.gif') }})', 'background-repeat': 'no-repeat', 'background-position' : 'center'});">
            2021
        </a>
    </div>
    <div id="results">
        {% if weekends %}
            {% for weekend in weekends %}
                <div class="panel panel-group panel-collapse">
                    <div class="panel-heading text-center">
                        Heading group
                    </div>
                    <div class="panel panel-default">
                        {% for key, table in weekend %}
                            {% if key is not same as('summary') %}{{ table|raw }} {% endif %}
                        {% endfor %}
                        {% if weekend.summary %}
                            <div class="panel panel-default">
                                <div class="panel-heading text-center">
                                    {% set title = weekend.summary.0.race.name|split(' - ').0 %}
                                    <strong>{{ title }}</strong>
                                </div>
                                <table class="table table-striped">
                                    <thead>
                                    <tr>
                                        <th>
                                            <strong class="color-two">{{ ('alternativeChampionship_name')|trans }}</strong>
                                        </th>
                                        <th>
                                            <strong class="color-two">{{ ('alternativeChampionship_collected_points')|trans }}</strong>
                                        </th>
                                        <th>
                                            <strong class="color-two">{{ ('alternativeChampionship_converted_points')|trans }}</strong>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for ac in weekend.summary %}
                                        <tr>
                                            <td>
                                                <strong>{{ ac.getUser.getName }}</strong>
                                            </td>
                                            <td>
                                                <strong>{{ ac.getCollectedPoints }}</strong>
                                            </td>
                                            <td>
                                                <strong class="color-one">{{ ac.getPoints }}</strong>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}

        {% else %}
            {% include('controller/module/no_results.html.twig') %}
        {% endif %}
    </div>
{% endblock %}
